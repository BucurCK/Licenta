   1              	 .syntax unified
   2              	 .cpu cortex-m4
   3              	 .eabi_attribute 27,3
   4              	 .fpu fpv4-sp-d16
   5              	 .eabi_attribute 20,1
   6              	 .eabi_attribute 21,1
   7              	 .eabi_attribute 23,3
   8              	 .eabi_attribute 24,1
   9              	 .eabi_attribute 25,1
  10              	 .eabi_attribute 26,1
  11              	 .eabi_attribute 30,6
  12              	 .eabi_attribute 34,1
  13              	 .eabi_attribute 18,4
  14              	 .thumb
  15              	 .file "motor_data_update.c"
  16              	 .text
  17              	.Ltext0:
  18              	 .cfi_sections .debug_frame
  19              	 .comm CCU8_CC8_CR1_CR1_Value,4,4
  20              	 .global motor_spd
  21              	 .section .bss.motor_spd,"aw",%nobits
  22              	 .align 2
  25              	motor_spd:
  26 0000 00000000 	 .space 4
  27              	 .global timer_value_slow
  28              	 .section .bss.timer_value_slow,"aw",%nobits
  29              	 .align 1
  32              	timer_value_slow:
  33 0000 0000     	 .space 2
  34              	 .global timer_value_old_slow
  35              	 .section .bss.timer_value_old_slow,"aw",%nobits
  36              	 .align 1
  39              	timer_value_old_slow:
  40 0000 0000     	 .space 2
  41              	 .section .text.init_position,"ax",%progbits
  42              	 .align 2
  43              	 .global init_position
  44              	 .thumb
  45              	 .thumb_func
  47              	init_position:
  48              	.LFB196:
  49              	 .file 1 "../motor_data_update.c"
   1:../motor_data_update.c **** #include <stdint.h>
   2:../motor_data_update.c **** #include <stdbool.h>
   3:../motor_data_update.c **** // #include <xmc_common.h>
   4:../motor_data_update.c **** #include "driver_pwm.h"
   5:../motor_data_update.c **** #include "motor_data_update.h"
   6:../motor_data_update.c **** #include "transform.h"
   7:../motor_data_update.c **** #include "main.h"
   8:../motor_data_update.c **** #include <math.h>
   9:../motor_data_update.c **** #include "driver_pwm.h"
  10:../motor_data_update.c **** #include "timer.h"
  11:../motor_data_update.c **** #include "driver_adc.h"
  12:../motor_data_update.c **** 
  13:../motor_data_update.c **** int32_t motor_spd = 0;
  14:../motor_data_update.c **** uint16_t timer_value_slow = 0;
  15:../motor_data_update.c **** uint16_t timer_value_old_slow = 0;
  16:../motor_data_update.c **** 
  17:../motor_data_update.c **** /**
  18:../motor_data_update.c ****  * Initialize position for motor
  19:../motor_data_update.c ****  * Enable PWM output
  20:../motor_data_update.c ****  * B High -> wait -> A High 0 -> wait
  21:../motor_data_update.c ****  * Reset: Theta | Position | Timers_old
  22:../motor_data_update.c ****  * Disable PWM output
  23:../motor_data_update.c ****  */
  24:../motor_data_update.c **** void init_position(void)	//TO DO:check if it still works
  25:../motor_data_update.c **** {
  50              	 .loc 1 25 0
  51              	 .cfi_startproc
  52              	 
  53              	 
  54 0000 80B5     	 push {r7,lr}
  55              	.LCFI0:
  56              	 .cfi_def_cfa_offset 8
  57              	 .cfi_offset 7,-8
  58              	 .cfi_offset 14,-4
  59 0002 00AF     	 add r7,sp,#0
  60              	.LCFI1:
  61              	 .cfi_def_cfa_register 7
  26:../motor_data_update.c **** 	motion_on();			// Enable PWM pins
  62              	 .loc 1 26 0
  63 0004 FFF7FEFF 	 bl motion_on
  27:../motor_data_update.c **** 	pwm_update(0, 4000); // Apply voltage on B Phase
  64              	 .loc 1 27 0
  65 0008 0020     	 movs r0,#0
  66 000a 4FF47A61 	 mov r1,#4000
  67 000e FFF7FEFF 	 bl pwm_update
  28:../motor_data_update.c **** 	delay_t(SECOND_1 / 2);	// Wait 0.5s
  68              	 .loc 1 28 0
  69 0012 41F28830 	 movw r0,#5000
  70 0016 FFF7FEFF 	 bl delay_t
  29:../motor_data_update.c **** 
  30:../motor_data_update.c **** 	pwm_update(4000, 0); // Apply voltage on A Phase
  71              	 .loc 1 30 0
  72 001a 4FF47A60 	 mov r0,#4000
  73 001e 0021     	 movs r1,#0
  74 0020 FFF7FEFF 	 bl pwm_update
  31:../motor_data_update.c **** 	delay_t(SECOND_1 / 2);	// Wait 0.5s
  75              	 .loc 1 31 0
  76 0024 41F28830 	 movw r0,#5000
  77 0028 FFF7FEFF 	 bl delay_t
  32:../motor_data_update.c **** //	motion_off();			// Disable PWM pin			NEED TO CHECK if it still works
  33:../motor_data_update.c **** 
  34:../motor_data_update.c **** 	theta_fast = 0;
  78              	 .loc 1 34 0
  79 002c 084B     	 ldr r3,.L2
  80 002e 4FF00002 	 mov r2,#0
  81 0032 1A60     	 str r2,[r3]
  35:../motor_data_update.c **** 	mechanical_position_fast = 0;
  82              	 .loc 1 35 0
  83 0034 074B     	 ldr r3,.L2+4
  84 0036 0022     	 movs r2,#0
  85 0038 1A60     	 str r2,[r3]
  36:../motor_data_update.c **** 	timer_value_old_fast = CCU40_CC40->TIMER;
  86              	 .loc 1 36 0
  87 003a 074B     	 ldr r3,.L2+8
  88 003c 1B6F     	 ldr r3,[r3,#112]
  89 003e 9AB2     	 uxth r2,r3
  90 0040 064B     	 ldr r3,.L2+12
  91 0042 1A80     	 strh r2,[r3]
  37:../motor_data_update.c **** 	timer_value_old_slow = CCU40_CC40->TIMER;
  92              	 .loc 1 37 0
  93 0044 044B     	 ldr r3,.L2+8
  94 0046 1B6F     	 ldr r3,[r3,#112]
  95 0048 9AB2     	 uxth r2,r3
  96 004a 054B     	 ldr r3,.L2+16
  97 004c 1A80     	 strh r2,[r3]
  38:../motor_data_update.c **** }
  98              	 .loc 1 38 0
  99 004e 80BD     	 pop {r7,pc}
 100              	.L3:
 101              	 .align 2
 102              	.L2:
 103 0050 00000000 	 .word theta_fast
 104 0054 00000000 	 .word mechanical_position_fast
 105 0058 00C10040 	 .word 1073791232
 106 005c 00000000 	 .word timer_value_old_fast
 107 0060 00000000 	 .word timer_value_old_slow
 108              	 .cfi_endproc
 109              	.LFE196:
 111              	 .section .text.compute_speed,"ax",%progbits
 112              	 .align 2
 113              	 .global compute_speed
 114              	 .thumb
 115              	 .thumb_func
 117              	compute_speed:
 118              	.LFB197:
  39:../motor_data_update.c **** 
  40:../motor_data_update.c **** /*
  41:../motor_data_update.c ****  * Compute current speed
  42:../motor_data_update.c ****  * Slow loop
  43:../motor_data_update.c ****  */
  44:../motor_data_update.c **** void compute_speed(void)
  45:../motor_data_update.c **** {
 119              	 .loc 1 45 0
 120              	 .cfi_startproc
 121              	 
 122              	 
 123              	 
 124 0000 80B4     	 push {r7}
 125              	.LCFI2:
 126              	 .cfi_def_cfa_offset 4
 127              	 .cfi_offset 7,-4
 128 0002 00AF     	 add r7,sp,#0
 129              	.LCFI3:
 130              	 .cfi_def_cfa_register 7
  46:../motor_data_update.c **** 	timer_value_slow = CCU40_CC40->TIMER;
 131              	 .loc 1 46 0
 132 0004 0A4B     	 ldr r3,.L5
 133 0006 1B6F     	 ldr r3,[r3,#112]
 134 0008 9AB2     	 uxth r2,r3
 135 000a 0A4B     	 ldr r3,.L5+4
 136 000c 1A80     	 strh r2,[r3]
  47:../motor_data_update.c **** 	motor_spd = timer_value_slow - timer_value_old_slow;
 137              	 .loc 1 47 0
 138 000e 094B     	 ldr r3,.L5+4
 139 0010 1B88     	 ldrh r3,[r3]
 140 0012 1A46     	 mov r2,r3
 141 0014 084B     	 ldr r3,.L5+8
 142 0016 1B88     	 ldrh r3,[r3]
 143 0018 D31A     	 subs r3,r2,r3
 144 001a 084A     	 ldr r2,.L5+12
 145 001c 1360     	 str r3,[r2]
  48:../motor_data_update.c **** 	timer_value_old_slow = timer_value_slow;
 146              	 .loc 1 48 0
 147 001e 054B     	 ldr r3,.L5+4
 148 0020 1A88     	 ldrh r2,[r3]
 149 0022 054B     	 ldr r3,.L5+8
 150 0024 1A80     	 strh r2,[r3]
  49:../motor_data_update.c **** }
 151              	 .loc 1 49 0
 152 0026 BD46     	 mov sp,r7
 153              	.LCFI4:
 154              	 .cfi_def_cfa_register 13
 155              	 
 156 0028 5DF8047B 	 ldr r7,[sp],#4
 157              	.LCFI5:
 158              	 .cfi_restore 7
 159              	 .cfi_def_cfa_offset 0
 160 002c 7047     	 bx lr
 161              	.L6:
 162 002e 00BF     	 .align 2
 163              	.L5:
 164 0030 00C10040 	 .word 1073791232
 165 0034 00000000 	 .word timer_value_slow
 166 0038 00000000 	 .word timer_value_old_slow
 167 003c 00000000 	 .word motor_spd
 168              	 .cfi_endproc
 169              	.LFE197:
 171              	 .text
 172              	.Letext0:
 173              	 .file 2 "c:\\dave-ide-4.4.2-64bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\machine\\_default_types.h"
 174              	 .file 3 "c:\\dave-ide-4.4.2-64bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\stdint.h"
 175              	 .file 4 "C:/GitHub/Stepper_drive/Libraries/CMSIS/Infineon/XMC4800_series/Include/XMC4800.h"
 176              	 .file 5 "c:\\dave-ide-4.4.2-64bit\\eclipse\\arm-gcc-49\\arm-none-eabi\\include\\math.h"
 177              	 .file 6 "C:/GitHub/Stepper_drive/Libraries/CMSIS/Include/core_cm4.h"
 178              	 .file 7 "../main.h"
 179              	 .file 8 "../transform.h"
DEFINED SYMBOLS
                            *ABS*:00000000 motor_data_update.c
                            *COM*:00000004 CCU8_CC8_CR1_CR1_Value
    {standard input}:25     .bss.motor_spd:00000000 motor_spd
    {standard input}:22     .bss.motor_spd:00000000 $d
    {standard input}:32     .bss.timer_value_slow:00000000 timer_value_slow
    {standard input}:29     .bss.timer_value_slow:00000000 $d
    {standard input}:39     .bss.timer_value_old_slow:00000000 timer_value_old_slow
    {standard input}:36     .bss.timer_value_old_slow:00000000 $d
    {standard input}:42     .text.init_position:00000000 $t
    {standard input}:47     .text.init_position:00000000 init_position
    {standard input}:103    .text.init_position:00000050 $d
    {standard input}:112    .text.compute_speed:00000000 $t
    {standard input}:117    .text.compute_speed:00000000 compute_speed
    {standard input}:164    .text.compute_speed:00000030 $d
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
motion_on
pwm_update
delay_t
theta_fast
mechanical_position_fast
timer_value_old_fast
